<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Physical Computing 1-67</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">
        <h1>Physical Computing Project 2024 - IT KMITL</h1>
        <h1>Smart Gas Detector</h1>
        <p>รายงานฉบับนี้จัดทำขึ้นเพื่อเป็นส่วนหนึ่งของวิชา PHYSICAL COMPUTING รหัสวิชา 06016409 ชั้นปีที่ 2 สถาบันเทคโนโลยีพระจอมเกล้าเจ้าคุณทหารลาดกระบัง</p>
    </div>
    
    <nav class="navigation">
        <a href="#post1">ที่มาและความคิดริเริ่มสร้างสรรค์</a>
        <a href="#post2">รายละเอียดของโปรเจกต์</a>
        <a href="#post3">จุดประสงค์ของโปรเจกต์</a>
        <a href="#post4">รายละเอียด</a>
        <a href="#post5">โปรเจกต์นี้สามารถทำงานได้ดังนี้</a>
        <a href="#post6">คลิปวิดีโอนำเสนอ</a>
        <a href="#post7">source code</a>
    </nav>
    
    <div class="post" id = "post1">
        <h3>ที่มาและความคิดริเริ่มสร้างสรรค์</h3>
        <p>&nbsp;&nbsp;&nbsp;&nbsp;การใช้แก๊สเป็นเชื้อเพลิงและพลังงานในหลายด้านกลายเป็นเรื่องปกติและแพร่หลายในชีวิตประจำวัน ไม่ว่าจะเป็น ครัวเรือน: ใช้สำหรับประกอบอาหาร คมนาคม: ใช้เป็นเชื้อเพลิงสำหรับรถยนต์และยานพาหนะบางประเภท อุตสาหกรรม: โรงงานต่าง ๆ ใช้แก๊สในกระบวนการผลิตสินค้า สถานประกอบการ: ร้านอาหาร สถานที่ที่ต้องการการควบคุมความปลอดภัยสูง: เช่น โรงพยาบาลและห้องปฏิบัติการต่าง ๆ แก๊สเป็นสารไวไฟที่ต้องการการจัดการอย่างระมัดระวัง การป้องกันการรั่วไหลของแก๊สจึงเป็นสิ่งสำคัญเพื่อความปลอดภัยของผู้ใช้งานและป้องกันอันตรายที่อาจเกิดขึ้น</p>
    </div>

    <div class="post" id = "post2">
        <h3>รายละเอียดของโปรเจกต์</h3>
        <p>&nbsp;&nbsp;&nbsp;&nbsp;โครงงานนี้เป็นการใช้ Microcontroller ในการตรวจสอบการรั่วไหลของแก๊สที่เป็นอันตรายต่อมนุษย์และแจ้งเตือนต่อผู้ใช้งานอย่างทันท่วงทีเพื่อป้องกันภัยที่เกิดขึ้น Microcontroller ที่ใช้คือ ESP32 Sensorในการตรวจจับแก๊สคือ MQ-9 Sensor Gas และแสดงผลด้วยจอ 0.96 inch OLED และมีBuzzerกับLEDเพื่อส่งสัญญาณเมื่อแก๊สรั่วไหล เมื่อSensorตรวจจับแก๊สได้Microcontroller จะส่งNotifyไปที่LINEของผู้ใช้งานและจะส่งสัญญาณเสียงBuzzerและสัญญาณไฟLEDเพื่อแจ้งเตือนผู้คนที่อยู่รอบข้าง</p>
    </div>

    <div class="post" id="post3">
        <h3>จุดประสงค์ของโปรเจกต์</h3>
        <p>&nbsp;&nbsp;&nbsp;&nbsp; - เพิ่มความปลอดภัย: ตรวจจับและแจ้งเตือนการรั่วไหลของแก๊สอย่างรวดเร็ว เพื่อลดความเสี่ยงจากการระเบิด เพลิงไหม้ หรืออันตรายจากการสูดดมแก๊สพิษ</p>
        <p>&nbsp;&nbsp;&nbsp;&nbsp; - ส่งการแจ้งเตือนถึงผู้ใช้งานผ่านอุปกรณ์ต่าง ๆ เช่น แอปมือถือ สัญญาณเสียง หรือไฟแจ้งเตือน เพื่อให้ผู้ใช้สามารถตอบสนองได้อย่างรวดเร็ว</p>
        <p>&nbsp;&nbsp;&nbsp;&nbsp; - เพื่อเสริมประสิทธิภาพระบบรักษาความปลอดภัย: เชื่อมต่อกับระบบความปลอดภัยอื่น ๆ เช่น ระบบดับเพลิงหรือระบบระบายอากาศอัตโนมัติ</p>
        <p>&nbsp;&nbsp;&nbsp;&nbsp; - เพื่อพัฒนาการในการประยุกต์ใช้ Microcontroller</p>
    </div>

    <div class="post" id="post4">
        <h3>รายละเอียด</h3>
        <p>&nbsp;&nbsp;&nbsp;&nbsp;โครงงานนี้เป็นการใช้ Microcontroller ในการตรวจสอบการรั่วไหลของแก๊สที่เป็นอันตรายต่อมนุษย์และแจ้งเตือนต่อผู้ใช้งานอย่างทันท่วงทีเพื่อป้องกันภัยที่เกิดขึ้น 
        Microcontroller ที่ใช้คือ ESP32 Sensorในการตรวจจับแก๊สคือ MQ-9 Sensor Gas และแสดงผลด้วยจอ 0.96 inch OLED และมีBuzzerกับLEDเพื่อส่งสัญญาณเมื่อแก๊สรั่วไหล 
        เมื่อSensorตรวจจับแก๊สได้Microcontroller จะส่งNotifyไปที่LINEของผู้ใช้งานและจะส่งสัญญาณเสียงBuzzerและสัญญาณไฟLEDเพื่อแจ้งเตือนผู้คนที่อยู่รอบข้าง</p>

    </div>

    <div class="post" id="post5">
        <h3>โปรเจกต์นี้สามารถทำงานได้ดังนี้:</h3>
        <pre>1.ตรวจจับความเข้มข้นของแก๊ส: ใช้เซนเซอร์อ่านค่าความเข้มข้นของแก๊ส (ในที่นี้คือ Butane) และแสดงค่าในรูปแบบกราฟแท่งบนจอ OLED เพื่อให้เห็นระดับความเข้มข้นของแก๊ส ณ ขณะนั้น
2.แจ้งเตือนเมื่อแก๊สเกินค่าที่กำหนด: เมื่อความเข้มข้นของแก๊สสูงกว่าระดับที่ตั้งไว้ (เช่น มากกว่า 6 V) เครื่องจะทำการ:
    -เปิดไฟ LED และเปิดเสียงเตือน (buzzer) เพื่อให้ผู้ใช้งานในบริเวณใกล้เคียงทราบถึงความอันตราย
    -แสดงข้อความเตือนบนจอ OLED เพื่อย้ำว่าแก๊สอยู่ในระดับอันตราย
3.แจ้งเตือนผ่าน LINE Notify: ส่งข้อความเตือนไปยังแอปพลิเคชัน LINE ของผู้ใช้งาน โดยการส่งข้อความแจ้งเตือนเมื่อพบว่าความเข้มข้นของแก๊สสูงเกินระดับปลอดภัย ทำให้ผู้ใช้งานสามารถรับรู้สถานะการรั่วไหลของแก๊สได้จากระยะไกล
            
            </pre>
    </div>

    <div class="post" id="post6">
        <h3 >คลิปวิดีโอนำเสนอ</h3>
        <a href="https://youtu.be/gUXTy4dL-Ww">https://youtu.be/gUXTy4dL-Ww</a>
    </div>

    <div class="post" id="post7">
        <h3>source code</h3>
        <div class="post1"> 
            <pre style="color: aliceblue;">
                #include &lt;Wire.h&gt;                           
                #include &lt;Adafruit_GFX.h&gt;                    
                #include &lt;Adafruit_SSD1306.h&gt;                 
                #include &lt;WiFiMulti.h&gt;
                #include &lt;ArtronShop_LineNotify.h&gt;
                
                #define WIFI_SSID "--------" // WiFi Name
                #define WIFI_PASSWORD "--------" // WiFi Password
                
                #define LINE_TOKEN "--------------------------" // LINE Token
                
                WiFiMulti wifiMulti;
                
                unsigned long lastSendTime = 0;   // เวลาสุดท้ายที่ส่งไปยัง Line Notify
                const unsigned long sendInterval = 30000; // ส่งข้อมูลทุกๆ 30 วินาที
                
                #define sensor 34                        
                #define buzzer 4                      
                #define led 2                       
                #define SCREEN_WIDTH 128 // OLED display width, in pixels
                #define SCREEN_HEIGHT 64 // OLED display height, in pixels
                #define OLED_RESET   -1                  
                
                Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &Wire, OLED_RESET);
                
                void setup() {  
                  pinMode(buzzer,OUTPUT);                 
                  pinMode(led,OUTPUT);                       
                  Serial.begin(115200);
                
                  Serial.println();
                  Serial.println();
                  Serial.println();
                
                  WiFi.mode(WIFI_STA);
                  wifiMulti.addAP(WIFI_SSID, WIFI_PASSWORD);
                
                  // wait for WiFi connection
                  Serial.print("Waiting for WiFi to connect...");
                  while ((wifiMulti.run() != WL_CONNECTED)) {
                    Serial.print(".");
                  }
                  Serial.println(" connected");
                
                  LINE.begin(LINE_TOKEN);
                
                  if(!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) { 
                    Serial.println(F("SSD1306 allocation failed"));
                    for(;;); // 
                  }
                  display.display();                          
                  display.clearDisplay();                   
                  
                }
                
                
                void loop() {
                  
                  int values;                                                             
                  int grafX = 0;                                
                  display.clearDisplay();                    
                  values = analogRead(sensor);
                  values = map(values, 0, 4095, 0, 20);
                  grafX = map(values, 0, 20, 0, 127);          // map ค่ากับความกว้างของจอ
                  display.fillRect(0, 0, grafX, 16, WHITE);  // print กราฟค่า
                  
                  display.setTextSize(2);                     // ตั้งขนาดตัวอักษร
                  display.setTextColor(WHITE);                // ตั้งสีตัวอักษร
                  display.setCursor(5, 33);                     // ตั้งตำแหน่ง cursor
                  display.println("LOW");
                  display.setCursor(46, 33); 
                  display.println("BUTANE"); 
                  
                  display.setTextSize(2);                     
                  display.setTextColor(WHITE);                
                  display.setCursor(28, 50);
                  display.print("LEVELS");  // print ระดับแก๊ส
                  
                  display.setTextSize(1); 
                  display.setCursor(48, 20); 
                  display.print(values); // print ค่าแก๊ส
                  display.print(" V");
                  grafX = map(values, 0, 100, 0, 127);          
                  display.fillRect(0, 0, grafX, 16, WHITE);  
                  
                  if (values >= 6) {
                    unsigned long currentTime = millis(); 
                    
                    if (currentTime - lastSendTime > sendInterval) {
                      sendtoLine();                             // ส่งข้อความไปที่ Line Notify
                      lastSendTime = currentTime;               // อัพเดตเวลาสุดท้ายที่ส่ง
                    }
                    
                    digitalWrite(led, HIGH); // เปิดไฟ LED
                    digitalWrite(buzzer, HIGH); // เปิด buzzer 
                    
                    display.fillRect(0, 17, 128, 64, SSD1306_WHITE);
                    display.setTextColor(BLACK);                
                    display.setTextSize(2);
                    display.setCursor(5, 23);
                    display.print("BUTANE");
                    display.setTextSize(1);
                    display.setCursor(83, 28);
                    display.setTextSize(2);
                    display.setCursor(19, 45);
                    display.print("LEVELS!!");
                    
                    display.setTextColor(BLACK);                
                    display.setTextSize(2);
                    display.setCursor(39, 2);
                    display.print("HIGH");
                    
                  } else {                                       
                    digitalWrite(led, LOW);  // ปิดไฟ LED
                    digitalWrite(buzzer, LOW);  // ปิด buzzer
                  }
                  Serial.print(values);
                  Serial.println(" V");
                  display.display();  // อัพเดตจอแสดงผล
                  delay(500);
                }
                
                void sendtoLine() {
                  LINE.send("ตรวจพบแก๊สเกินกำหนด!!");
                }
            </pre></div>
    </div>


</body>
</html>
